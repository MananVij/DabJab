<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="icon" href="./public/4.png" type="image/png" sizes="16x16" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap"
      rel="stylesheet"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap"
      rel="stylesheet"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato&display=swap"
      rel="stylesheet"
    />

    <title>DabJab</title>
    <style>
      .hello:hover {
        transform: scale(1.01);
        transition-duration: 0.2s;
      }
      #loader {
        position: absolute;
        margin: auto;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        width: fit-content;
        height: fit-content;
      }
      #loader img {
        width: 40vh;
      }
      #content {
        display: none;
      }
      .card {
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
        background-color: #f1fafd;
        border-radius: 12px;
        border: 1px solid rgba(209, 213, 219, 0.3);
        box-shadow: 0 7px 30px -10px rgb(150 170 180 / 50%)
      }
    </style>
  </head>
  <body style="width: 100%; background-color: #f1fafd">
    <div id="loader">
      <img src="./public/plaster-new.gif" alt="" />
    </div>
    <div id="content">
      <!-- NavBar -->
      <nav
        class="navbar navbar-expand-lg navbar-light"
        style="
          background-color: #f1fafd;
          padding: 3rem 10% 0;
          font-family: 'Poppins', sans-serif;
        "
      >
        <a class="navbar-brand" href="#">
          <img
            src="./public/4.png"
            width="30"
            height="30"
            class="d-inline-block align-top"
            alt=""
          />
          DabJab
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse me-1"
          id="navbarNav"
          style="justify-content: end"
        >
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="./index.html"
                >Home <span class="sr-only">(current)</span></a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./alldata.html">Get Data</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./resgister-camp.html"
                >Register as Camp</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./notify.html">Set a Reminder</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./info.html">FAQ's</a>
            </li>
          </ul>
        </div>
      </nav>

      <!--        Form         -->
      <div>
        <div style="display: flex; justify-content: center">
          <div
            class="fluid-container card"
            style="
              align-items: center;
              flex-direction: column;
              padding-top: 5vh;
              padding-bottom: 4vh;
              margin-top: 10vh;
              margin-bottom: 4vh;
              width: 60%;
            "
          >
            <form action="">
              <div class="row container-fluid" style="margin: 0">
                <div
                  class="col-lg-12 col-md-12 col-sm-12"
                  style="justify-content: center; display: flex"
                >
                  <img src="./public/vaxicon.png" style="width: 50%" alt="" />
                </div>
                <div class="col-lg-6 col-md-12 col-sm-12">
                  <input
                    required
                    type="text"
                    class="form-control"
                    placeholder="Pincode"
                    id="pincode"
                  />
                </div>
                <div class="col-lg-6 col-md-12 col-sm-12">
                  <input
                    required
                    type="date"
                    class="form-control"
                    placeholder="Date"
                    id="date"
                  />
                </div>
                <div
                  class="col-lg-12"
                  style="
                    display: flex;
                    flex-direction: row;
                    justify-content: center;
                    padding-top: 2vh;
                  "
                >
                  <button
                    class="btn btn-md"
                    style="
                      background-color: #07a6c2;
                      color: white;
                      font-family: 'Poppins', sans-serif;
                    "
                  >
                    Check
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div style="display: flex; flex-direction: column; align-items: center;">
          <p></p>
          <!-- make card -->
          <div class="make-card" style="padding: 4vh">

          </div>
      </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>

    <script type="text/javascript">
      window.onload = function () {
        document.querySelector("#loader").style.display = "none";
        document.querySelector("#content").style.display = "block";
      };

      var today = new Date().toISOString().split('T')[0];
      document.querySelector("#date").setAttribute('min', today);

      const output = document.querySelector("p");
      const form = document.querySelector("form");
      const searchPincode = document.querySelector("#pincode");
      const searchDate = document.querySelector("#date");

      const card = document.querySelector('.make-card')

      form.addEventListener("submit", (e) => {
        output.innerHTML = "";
        loader.style.display = "block";
        content.style.display = "none";
        e.preventDefault();
        const pincode = searchPincode.value;

        const dateInput = searchDate.value;
        const year = dateInput.slice(0, 4);
        const month = dateInput.slice(5, 7);
        const date = dateInput.slice(8, 10);

        //final date in dd-mm-yyyy
        const dateSearched = date + "-" + month + "-" + year;

        fetch(
          "https://dabjab.herokuapp.com/getcampdata?date=" +
            dateSearched +
            "&pincode=" +
            pincode
        )
          .then((res) => {
            loader.style.display = "none";
            content.style.display = "block";
            res
              .json()
              .then((data) => {
                if (!data) {
                  return (output.innerHTML = "No Sessions Found");
                }
                data.map((abc, index) => {
                  return card.innerHTML +=                     
                    `    <div class="card hello border-primary " style= "margin: 2vh 0">
                        <div class="card-body" >
                            <b>Hospital Name:</b> ${abc.placeName} <br/><b> Hospital Address:</b> ${abc.hospitalAddress} <br/> <b>Vaccine Name:</b>  ${abc.vaccine} <br/> <b>Fees:</b> Rs. ${abc.fee} <br/><b>Date:</b> ${abc.date} <br/><b>Timing:</b> ${abc.timeStart} - ${abc.timeEnd} <br/> <b>Dose One:</b> ${abc.availDoseOne} <br/> <b>Dose Two:</b> ${abc.availDoseTwo} <br/>
                          </div>
                        </div>
                    `
                });
              })
              .catch((e) => {
                output.innerHTML = "No Camp Found";
                console.log(e.message);
              });
          })
          .catch((e) => {
            console.log(e.message);
          });
      });
    </script>
  </body>
</html>
